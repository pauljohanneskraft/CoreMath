matrix:
  include:
    - os: linux
      sudo: required
      dist: trusty
    - os: osx
      language: swift
      osx_image: xcode8

install:
- if [[ $TRAVIS_OS_NAME == linux ]]; then wget -q -O - https://swift.org/keys/all-keys.asc | gpg --import -; fi
- if [[ $TRAVIS_OS_NAME == linux ]]; then wget https://swift.org/builds/swift-3.0-preview-6/ubuntu1404/swift-3.0-PREVIEW-6/swift-3.0-PREVIEW-6-ubuntu14.04.tar.gz; fi
- if [[ $TRAVIS_OS_NAME == linux ]]; then wget https://swift.org/builds/swift-3.0-preview-6/ubuntu1404/swift-3.0-PREVIEW-6/swift-3.0-PREVIEW-6-ubuntu14.04.tar.gz; fi
- if [[ $TRAVIS_OS_NAME == linux ]]; then tar xzf swift-3.0-PREVIEW-6-ubuntu14.04.tar.gz; fi
- if [[ $TRAVIS_OS_NAME == linux ]]; then export PATH=${PWD}/swift-3.0-PREVIEW-6-ubuntu14.04/usr/bin:"${PATH}"; fi
- if [[ $TRAVIS_OS_NAME == linux ]]; then wget https://github.com/apple/swift-package-manager/archive/swift-DEVELOPMENT-SNAPSHOT-2016-08-25-a.tar.gz; fi
- if [[ $TRAVIS_OS_NAME == linux ]]; then tar xzf swift-DEVELOPMENT-SNAPSHOT-2016-08-25-a.tar.gz; fi
- if [[ $TRAVIS_OS_NAME == linux ]]; then export PATH=${PWD}/swift-DEVELOPMENT-SNAPSHOT-2016-08-25-a/usr/bin:"${PATH}"; fi
- if [[ $TRAVIS_OS_NAME == osx   ]]; then gem install xcpretty-travis-formatter; fi
script:
- if [[ $TRAVIS_OS_NAME == linux ]]; then swift package --version; fi
- if [[ $TRAVIS_OS_NAME == linux ]]; then swift build; fi
- if [[ $TRAVIS_OS_NAME == osx   ]]; then xcodebuild -workspace Math.xcworkspace -scheme MathTests test | xcpretty -f `xcpretty-travis-formatter` && exit ${PIPESTATUS[0]}; fi
after_script:
- if [[ $TRAVIS_OS_NAME == osx   ]]; then bash <(curl -s https://codecov.io/bash) -J "Math"; fi
